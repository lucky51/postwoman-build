ace.define("ace/ext/elastic_tabstops_lite",["require","exports","module","ace/editor","ace/config"],(function(t,e,o){"use strict";var n=function(t){this.$editor=t;var e=this,o=[],n=!1;this.onAfterExec=function(){n=!1,e.processRows(o),o=[]},this.onExec=function(){n=!0},this.onChange=function(t){n&&(-1==o.indexOf(t.start.row)&&o.push(t.start.row),t.end.row!=t.start.row&&o.push(t.end.row))}};(function(){this.processRows=function(t){this.$inChange=!0;for(var e=[],o=0,n=t.length;o<n;o++){var r=t[o];if(!(e.indexOf(r)>-1))for(var h=this.$findCellWidthsForBlock(r),c=this.$setBlockCellWidthsToMax(h.cellWidths),l=h.firstRow,f=0,d=c.length;f<d;f++){var v=c[f];e.push(l),this.$adjustRow(l,v),l++}}this.$inChange=!1},this.$findCellWidthsForBlock=function(t){for(var e,o=[],n=t;n>=0&&0!=(e=this.$cellWidthsForRow(n)).length;)o.unshift(e),n--;var r=n+1;n=t;for(var h=this.$editor.session.getLength();n<h-1&&(n++,0!=(e=this.$cellWidthsForRow(n)).length);)o.push(e);return{cellWidths:o,firstRow:r}},this.$cellWidthsForRow=function(t){for(var e=this.$selectionColumnsForRow(t),o=[-1].concat(this.$tabsForRow(t)),n=o.map((function(t){return 0})).slice(1),line=this.$editor.session.getLine(t),i=0,r=o.length-1;i<r;i++){var h=o[i]+1,c=o[i+1],l=this.$rightmostSelectionInCell(e,c),f=line.substring(h,c);n[i]=Math.max(f.replace(/\s+$/g,"").length,l-h)}return n},this.$selectionColumnsForRow=function(t){var e=[],cursor=this.$editor.getCursorPosition();return this.$editor.session.getSelection().isEmpty()&&t==cursor.row&&e.push(cursor.column),e},this.$setBlockCellWidthsToMax=function(t){for(var e,o,n,r=!0,h=this.$izip_longest(t),c=0,l=h.length;c<l;c++){var f=h[c];if(f.push){f.push(NaN);for(var d=0,s=f.length;d<s;d++){var v=f[d];if(r&&(e=d,n=0,r=!1),isNaN(v)){o=d;for(var $=e;$<o;$++)t[$][c]=n;r=!0}n=Math.max(n,v)}}else console.error(f)}return t},this.$rightmostSelectionInCell=function(t,e){var o=0;if(t.length){for(var n=[],s=0,r=t.length;s<r;s++)t[s]<=e?n.push(s):n.push(0);o=Math.max.apply(Math,n)}return o},this.$tabsForRow=function(t){for(var e,o=[],line=this.$editor.session.getLine(t),n=/\t/g;null!=(e=n.exec(line));)o.push(e.index);return o},this.$adjustRow=function(t,e){var o=this.$tabsForRow(t);if(0!=o.length)for(var n=0,r=-1,h=this.$izip(e,o),i=0,c=h.length;i<c;i++){var l=h[i][0],f=h[i][1],d=(r+=1+l)-(f+=n);if(0!=d){var v=this.$editor.session.getLine(t).substr(0,f),$=v.replace(/\s*$/g,""),m=v.length-$.length;d>0&&(this.$editor.session.getDocument().insertInLine({row:t,column:f+1},Array(d+1).join(" ")+"\t"),this.$editor.session.getDocument().removeInLine(t,f,f+1),n+=d),d<0&&m>=-d&&(this.$editor.session.getDocument().removeInLine(t,f+d,f),n+=d)}}},this.$izip_longest=function(t){if(!t[0])return[];for(var e=t[0].length,o=t.length,i=1;i<o;i++){var n=t[i].length;n>e&&(e=n)}for(var r=[],h=0;h<e;h++){var c=[];for(i=0;i<o;i++)""===t[i][h]?c.push(NaN):c.push(t[i][h]);r.push(c)}return r},this.$izip=function(t,e){for(var o=t.length>=e.length?e.length:t.length,n=[],i=0;i<o;i++){var r=[t[i],e[i]];n.push(r)}return n}}).call(n.prototype),e.ElasticTabstopsLite=n;var r=t("../editor").Editor;t("../config").defineOptions(r.prototype,"editor",{useElasticTabstops:{set:function(t){t?(this.elasticTabstops||(this.elasticTabstops=new n(this)),this.commands.on("afterExec",this.elasticTabstops.onAfterExec),this.commands.on("exec",this.elasticTabstops.onExec),this.on("change",this.elasticTabstops.onChange)):this.elasticTabstops&&(this.commands.removeListener("afterExec",this.elasticTabstops.onAfterExec),this.commands.removeListener("exec",this.elasticTabstops.onExec),this.removeListener("change",this.elasticTabstops.onChange))}}})})),ace.require(["ace/ext/elastic_tabstops_lite"],(function(t){"object"==typeof module&&"object"==typeof exports&&module&&(module.exports=t)}));