ace.define("ace/ext/beautify",["require","exports","module","ace/token_iterator"],(function(e,t,r){"use strict";var o=e("../token_iterator").TokenIterator;function n(e,t){return e.type.lastIndexOf(t+".xml")>-1}t.singletonTags=["area","base","br","col","command","embed","hr","html","img","input","keygen","link","meta","param","source","track","wbr"],t.blockTags=["article","aside","blockquote","body","div","dl","fieldset","footer","form","head","header","html","nav","ol","p","script","section","style","table","tbody","tfoot","thead","ul"],t.beautify=function(e){for(var r,c,i,l=new o(e,0,0),m=l.getCurrentToken(),f=e.getTabString(),h=t.singletonTags,y=t.blockTags,d=!1,$=!1,k=!1,code="",x="",w="",v=0,T=0,R=0,O=0,C=0,I=0,_=0,j=0,B=0,F=!1,S=!1,K=!1,L=!1,V={0:0},z=[],A=function(){r&&r.value&&"string.regexp"!==r.type&&(r.value=r.value.replace(/^\s*/,""))},D=function(){code=code.replace(/ +$/,"")},E=function(){code=code.trimRight(),d=!1};null!==m;){if(j=l.getCurrentTokenRow(),l.$rowTokens,r=l.stepForward(),void 0!==m){if(x=m.value,C=0,K="style"===w||"ace/mode/css"===e.$modeId,n(m,"tag-open")?(S=!0,r&&(L=-1!==y.indexOf(r.value)),"</"===x&&(L&&!d&&B<1&&B++,K&&(B=1),C=1,L=!1)):n(m,"tag-close")?S=!1:n(m,"comment.start")?L=!0:n(m,"comment.end")&&(L=!1),S||B||"paren.rparen"!==m.type||"}"!==m.value.substr(0,1)||B++,j!==c&&(B=j,c&&(B-=c)),B){for(E();B>0;B--)code+="\n";d=!0,n(m,"comment")||m.type.match(/^(comment|string)$/)||(x=x.trimLeft())}if(x){if("keyword"===m.type&&x.match(/^(if|else|elseif|for|foreach|while|switch)$/)?(z[v]=x,A(),k=!0,x.match(/^(else|elseif)$/)&&code.match(/\}[\s]*$/)&&(E(),$=!0)):"paren.lparen"===m.type?(A(),"{"===x.substr(-1)&&(k=!0,F=!1,S||(B=1)),"{"===x.substr(0,1)&&($=!0,"["!==code.substr(-1)&&"["===code.trimRight().substr(-1)?(E(),$=!1):")"===code.trimRight().substr(-1)?E():D())):"paren.rparen"===m.type?(C=1,"}"===x.substr(0,1)&&("case"===z[v-1]&&C++,"{"===code.trimRight().substr(-1)?E():($=!0,K&&(B+=2))),"]"===x.substr(0,1)&&"}"!==code.substr(-1)&&"}"===code.trimRight().substr(-1)&&($=!1,O++,E()),")"===x.substr(0,1)&&"("!==code.substr(-1)&&"("===code.trimRight().substr(-1)&&($=!1,O++,E()),D()):"keyword.operator"!==m.type&&"keyword"!==m.type||!x.match(/^(=|==|===|!=|!==|&&|\|\||and|or|xor|\+=|.=|>|>=|<|<=|=>)$/)?"punctuation.operator"===m.type&&";"===x?(E(),A(),k=!0,K&&B++):"punctuation.operator"===m.type&&x.match(/^(:|,)$/)?(E(),A(),x.match(/^(,)$/)&&_>0&&0===I?B++:(k=!0,d=!1)):"support.php_tag"!==m.type||"?>"!==x||d?n(m,"attribute-name")&&code.substr(-1).match(/^\s$/)?$=!0:n(m,"attribute-equals")?(D(),A()):n(m,"tag-close")&&(D(),"/>"===x&&($=!0)):(E(),$=!0):(E(),A(),$=!0,k=!0),d&&(!m.type.match(/^(comment)$/)||x.substr(0,1).match(/^[/#]$/))&&(!m.type.match(/^(string)$/)||x.substr(0,1).match(/^['"]$/))){if(O=R,v>T)for(O++,i=v;i>T;i--)V[i]=O;else v<T&&(O=V[v]);for(T=v,R=O,C&&(O-=C),F&&!I&&(O++,F=!1),i=0;i<O;i++)code+=f}if("keyword"===m.type&&x.match(/^(case|default)$/)&&(z[v]=x,v++),"keyword"===m.type&&x.match(/^(break)$/)&&z[v-1]&&z[v-1].match(/^(case|default)$/)&&v--,"paren.lparen"===m.type&&(I+=(x.match(/\(/g)||[]).length,_+=(x.match(/\{/g)||[]).length,v+=x.length),"keyword"===m.type&&x.match(/^(if|else|elseif|for|while)$/)?(F=!0,I=0):!I&&x.trim()&&"comment"!==m.type&&(F=!1),"paren.rparen"===m.type)for(I-=(x.match(/\)/g)||[]).length,_-=(x.match(/\}/g)||[]).length,i=0;i<x.length;i++)v--,"}"===x.substr(i,1)&&"case"===z[v]&&v--;"text"==m.type&&(x=x.replace(/\s+$/," ")),$&&!d&&(D(),"\n"!==code.substr(-1)&&(code+=" ")),code+=x,k&&(code+=" "),d=!1,$=!1,k=!1,(n(m,"tag-close")&&(L||-1!==y.indexOf(w))||n(m,"doctype")&&">"===x)&&(B=L&&r&&"</"===r.value?-1:1),n(m,"tag-open")&&"</"===x?v--:n(m,"tag-open")&&"<"===x&&-1===h.indexOf(r.value)?v++:n(m,"tag-name")?w=x:n(m,"tag-close")&&"/>"===x&&-1===h.indexOf(w)&&v--,c=j}}m=r}code=code.trim(),e.doc.setValue(code)},t.commands=[{name:"beautify",description:"Format selection (Beautify)",exec:function(e){t.beautify(e.session)},bindKey:"Ctrl-Shift-B"}]})),ace.require(["ace/ext/beautify"],(function(e){"object"==typeof module&&"object"==typeof exports&&module&&(module.exports=e)}));